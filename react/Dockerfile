FROM node:20-alpine

ARG VITE_SERVER_HTTP_URL
ARG VITE_SERVER_WS_URL
ARG VITE_POSTHOG_KEY
ARG VITE_POSTHOG_HOST
ARG VITE_CLARITY_PROJECT_ID

ENV VITE_SERVER_HTTP_URL=$VITE_SERVER_HTTP_URL
ENV VITE_SERVER_WS_URL=$VITE_SERVER_WS_URL
ENV VITE_POSTHOG_KEY=$VITE_POSTHOG_KEY
ENV VITE_POSTHOG_HOST=$VITE_POSTHOG_HOST
ENV VITE_CLARITY_PROJECT_ID=$VITE_CLARITY_PROJECT_ID

WORKDIR /app

COPY . /app

RUN npm install

RUN npm run build

CMD ["npm", "run", "preview:network"]
